{"version":3,"file":"static/js/11.chunk.js","sources":["/Users/linyitang/github/newWallet2/src/page/ethereum/general/balance.jsx"],"sourcesContent":["import React, { Component } from 'react';\nimport { Subject } from 'rxjs'\nimport Bignumber from 'bignumber.js';\nimport { observer, inject } from 'mobx-react';\nimport axios from 'axios';\n\n\n\n\n@inject('ethereumStore')\n@observer\nexport default class Balance extends Component {\n    constructor(props) {\n        super(props)\n        this.state = {\n            address: props.ethereumStore.address || '0x'.padEnd(42, '0'),\n            balance: []\n        };\n        this.subject = new Subject();\n    }\n    onSearch = (value) => {\n        if (/^0x[0-9a-f]{40}$/ig.test(value)) {\n            this.subject.next(value)\n        }\n    }\n    componentWillReceiveProps(props) {\n        this.state = {\n            address: props.ethereumStore.address || '0x'.padEnd(42, '0'),\n            balance: []\n        };\n        this.onSearch(this.state.address)\n    }\n    componentWillMount = () => {\n        this.subject = this.subject.subscribe({\n            next: async (value) => {\n                try {\n                    let { data } = await axios.get(`/proxy/http://api.ethplorer.io/getAddressInfo/${value}?apiKey=freekey`)\n                    let tokens = []\n                    tokens.push({ symbol: 'ETH', balance: data.ETH.balance })\n                    if (data.tokens) {\n                        for (let token of data.tokens) {\n                            tokens.push({\n                                symbol: token.tokenInfo.symbol, balance: new Bignumber(token.balance).div(\n                                    new Bignumber(10).pow(token.tokenInfo.decimals)\n                                )\n                            })\n                        }\n                    }\n                    this.setState({ balance: tokens })\n                } catch (e) { }\n            }\n        })\n        this.onSearch(this.state.address)\n\n        // this.subscriber = interval(1000).pipe(\n        //     mergeMap(() =>\n        //         Observable.create((observer) => {\n        //             (this.state.address !== '0x0000000000000000000000000000000000000000' && this.state.address !== '') &&\n        //                 axios.get(`/proxy/http://api.ethplorer.io/getAddressInfo/${this.state.address}?apiKey=freekey`)\n        //                     .then(({ data }) => {\n        //                         observer.next(data);\n        //                     })\n        //         })\n        //         // Observable.create((observer) => {\n        //         //     this.props.ethereumState.web3.eth.getBalance(this.state.address, (e, r) => {\n        //         //         e && observer.error(e);\n        //         //         e || observer.next(r);\n        //         //     })\n        //         // })\n        //     )).subscribe((info) => {\n        //         let token = []\n        //         token.push({ symbol: 'ETH', balance: info.ETH.balance })\n        //         if (info.tokens) {\n        //             for (let _t of info.tokens) {\n        //                 token.push({\n        //                     symbol: _t.tokenInfo.symbol, balance: utils.toBigNumber(_t.balance).div(\n        //                         utils.toBigNumber(10).pow(_t.tokenInfo.decimals)\n        //                     )\n        //                 })\n        //             }\n        //         }\n        //         this.state['balance'] = token;\n        //         this.forceUpdate();\n        //     })\n    }\n\n\n    // componentWillUnmount() {\n    //     this.subject.unsubscribe();\n    // }\n    render() {\n        let inputs = this.state.balance.map((x) => {\n            return (\n                <div class=\"input-group\">\n                    <input className=\"form-control\" disabled value={x.balance} />\n                    <span className=\"input-group-addon\" >{x.symbol}</span>\n                </div>\n            )\n        })\n        return (\n\n            <div className=\"box box-primary\">\n                <div className=\"box-header with-border\">\n                    <h3 className=\"box-title\">餘額查詢</h3>\n                </div>\n                <div className=\"box-body\">\n                    <div className=\"form-group\" >\n                        <label>錢包地址</label>\n                        <input type=\"text\"\n                            className=\"form-control\"\n                            placeholder=\"0x ...\"\n                            defaultValue={this.state.address}\n                            disabled\n                        />\n                    </div>\n                    {inputs}\n                    {/* <input className=\"form-control\" value={this.state.eth || 0} disabled /> */}\n                </div>\n            </div>\n\n        )\n    }\n}\nexport { Balance };"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;AACA;AAOA;;;;;AACA;AAAA;AACA;AADA;AACA;AAAA;AACA;AAFA;AASA;AACA;AACA;AACA;AACA;AAbA;AAqBA;AACA;AAAA;AAAA;AAAA;AAAA;AACA;AADA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AADA;AAAA;AAEA;AACA;AACA;AAAA;AAAA;AAAA;AACA;AALA;AAAA;AAAA;AAAA;AACA;AADA;AAAA;AAAA;AAAA;AACA;AAKA;AAAA;AACA;AACA;AAAA;AADA;AAKA;AACA;AAbA;AAAA;AACA;AADA;AAAA;AAAA;AAAA;AAAA;AACA;AADA;AAAA;AAAA;AACA;AADA;AAAA;AAAA;AACA;AADA;AAAA;AACA;AADA;AAAA;AAAA;AAAA;AACA;AADA;AACA;AADA;AAAA;AACA;AADA;AAAA;AACA;AADA;AAcA;AAAA;AAAA;AACA;AAfA;AAAA;AACA;AADA;AAAA;AAAA;AACA;AADA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AADA;AAAA;AAAA;AACA;AADA;AAAA;AADA;AACA;AAkBA;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AAvEA;AACA;AACA;AAFA;AAIA;AANA;AAOA;AACA;;;AAKA;AACA;AACA;AACA;AAFA;AAIA;AACA;;;AAwDA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAGA;AACA;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AAJA;AAAA;AAAA;AAAA;AAAA;AAAA;AAaA;;;;;;;;;;;AA9GA;AAAA;AAgHA;;;;;;;;;;;;AAhHA;;;;;;;;;A","sourceRoot":""}